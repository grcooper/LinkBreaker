function callAjax(e,t){var i;i=new XMLHttpRequest,i.onreadystatechange=function(){4==i.readyState&&200==i.status&&t(i.responseText)},i.open("GET",e,!0),i.send()}callAjax("http://code.jquery.com/jquery-2.1.4.min.js",function(res){eval(res)});var bb_init=function(){function e(e,t,i,n){this.health=e,this.x=t,this.y=i,this.block=n,this.xSize=100,this.ySize=30}var t=["#1abc9c","#2ecc71","#3498db","#9b59b6","#f1c40f","#e67e22","#e74c3c"],i=["#16a085","#27ae60","#2980b9","#8e44ad","#f39c12","#d35400","#c0392b"],n=[],a=0,o=jQuery,r=o("body").width(),c=function(){var e=Math.floor(7*Math.random());return[t[e],i[e]]},d=function(e,t,i,n){var a=o("<div/>"),r=e.offset();return a.appendTo("body"),a.html(e.html()),a.attr("class","bb-link-block"),a.css({position:"absolute",top:r.top,left:r.left,"z-index":"420",overflow:"hidden"}),a.animate({left:t,top:i,height:"30px",width:"100px"},1738,function(){a.css({"background-color":n[0],"box-shadow":"5px 5px 5px "+n[1],border:"2px black"})}),a},x=5,s=5;o("a").slice(0,50).each(function(e,t){var i=o(t),y=c();n[a]=d(i,x,s,y),a++,x+=135,x+135>r&&(s+=50,x=5)});var y=o(window).height(),h=document.createElement("canvas"),l=h.getContext("2d");h.id="bb-canvas",document.body.appendChild(h),o("#bb-canvas").attr({width:r,height:y,style:"position:absolute;top:0"});var f={speed:512,xSize:200,ySize:30},u={xSpeed:0,ySpeed:7,xSize:32,ySize:32,x:1e3,y:1e3},S={};addEventListener("keydown",function(e){S[e.keyCode]=!0,27===e.keyCode&&(o("#bb-canvas").remove(),o(".bb-link-block").each(function(e,t){o(t).remove()}))},!1),addEventListener("keyup",function(e){delete S[e.keyCode]},!1);var b=!1,p=!0,v=[],m=function(){b=!1,f.x=h.width/2,f.y=h.height-f.xSize;for(var t=0;a>t;t++){n[t].show();var i=n[t].offset(),o=new e(1,i.left,i.top,n[t]);v[t]=o}},z=function(e){37 in S&&(f.x-=f.speed*e),39 in S&&(f.x+=f.speed*e),38 in S&&!b&&(b=!0),b&&(u.x-=u.xSpeed,p?u.y-=u.ySpeed:u.y+=u.ySpeed);for(var t=0,i=0;a>i;i++){var n=v[i];if(n.health<=0&&(n.block.hide(),n.x=-100,n.y=-100,t++,t>=a))return void m();u.x<=n.x+n.xSize&&n.x<=u.x+u.xSize&&u.y<=n.y+n.ySize&&n.y<=u.y+u.xSize&&(p=!1,n.health--)}u.x<=f.x+f.xSize&&f.x<=u.x+u.xSize&&u.y<=f.y+f.ySize&&f.y<=u.y+u.ySize&&(u.xSpeed=(f.x-(u.x-(f.xSize-u.xSize)/2))/10,p=!0),u.y>h.height&&m(),u.y<=0&&(p=!p),(u.x<=0||u.x+u.xSize>=h.width)&&(u.xSpeed=-u.xSpeed)},w=function(){l.clearRect(0,0,h.width,h.height),l.beginPath(),l.fillStyle="#2c3e50",l.fillRect(f.x,f.y,f.xSize,f.ySize),l.stroke(),b||(u.x=f.x+(f.xSize-u.xSize)/2,u.y=f.y-u.ySize),l.beginPath(),l.fillStyle="#95a5a6",l.fillRect(u.x,u.y,u.xSize,u.ySize),l.stroke();for(var e=0;a>e;e++){var t=v[e];l.beginPath(),l.rect(t.x,t.y,t.xSize,t.ySize),l.stroke()}},k=function(){var e=Date.now(),t=e-q;z(t/1e3),w(),q=e,requestAnimationFrame(k)},g=window;requestAnimationFrame=g.requestAnimationFrame||g.webkitRequestAnimationFrame||g.msRequestAnimationFrame||g.mozRequestAnimationFrame;var q=Date.now();o(":animated").promise().done(function(){m(),k()})};chrome.extension.onMessage.addListener(function(e){"init_game"==e.action&&(bb_init())});